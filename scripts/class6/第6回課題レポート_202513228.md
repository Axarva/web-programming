# Webプログラミング 第6回 課題提出ファイル (Assignment Submission File)

**氏名 (Name):** Timsina Atharva  
**日付 (Date):** 2025年11月13日

---

## I. 提出課題: 正規表現の検証プログラム (Submission: RegEx Verification Program)

以下のファイルは、課題1, 2, 3の正規表現パターンを検証するために使用したRubyスクリプト`sample6-2.rb`です。

```rb
#!/usr/bin/env ruby
# encoding: utf-8
# Student ID: 202513228
# Student name: Atharva Timsna
# Class: Web Programming
# Professor: 永森 光晴
# Submission for 第6回課題1-3
print "Pattern: "
pattern = STDIN.gets.chomp
regexp = Regexp.new(pattern, false)

# gets は実行時に引数として与えられたファイルから
# 一行読み込んだ文字列を返す組み込み関数。
while line = gets
  if regexp =~ line
    print line
  end
end

# ruby sample6-2.rb meibo.txt
# • 以下を検索する正規表現を考え、sample6-2.rb使って結果を確認する
# 1. 「SATOH」か「SAITOH」を含む
# 2. 「ヒデユキ」か「ヒロユキ」を含む
# 3. 「サ」で始まる
# 4. 「ナ」か「サ」で始まり、「ユキ」を含む
# 5. 空白以外の同じ文字の繰り返しを含む

# 1. SAI?TOH
# 2. ヒ[デロ]ユキ
# 3. ^サ
# 4. ^[サナ].*?ユキ.*?
# 5. (\S)\1 
# 
#  以下の条件を検索する正規表現を考える
# 1. 偶数にマッチする正規表現
# – 2, 10, 2020, 008等，数字全体にマッチする
# – ＋/−の符号は考慮しない
# – 先頭に余分なゼロが付いていてもよい
# Answer: ^[0-9]*?[02468]$, \b[0-9]*?[02468]\b
# 2. 郵便番号にマッチする正規表現
# – 郵便番号は3桁の数字と4桁の数字をハイフンで
# 結んだ7桁の番号とする（例：305-8550）
# – ただし，ハイフンは省略可能
# – 正規表現「Go{5}al!」は"Goooooal!"にマッチする
# Answer: ^[0-9]{3}-?[0-9]{4}$, \b[0-9]{3}-?[0-9]{4}\b
# 
# Assignment 3
# Basic answer (not including 'll'): ^st.*?(\S)\1.*?l$
# Answer for extra points (includes 'll' on top of basic answer): ^st.*?((\S)\2.*?|l)l$
```

---

## II. 課題1

| No. | 条件 (Requirement) | 提出正規表現 (Submitted RegEx) |
| :---: | :--- | :--- |
| **1.** | 「SATOH」か「SAITOH」を含む | `SAI?TOH` |
| **2.** | 「ヒデユキ」か「ヒロユキ」を含む | `ヒ[デロ]ユキ` |
| **3.** | 「サ」で始まる | `^サ` |
| **4.** | 「ナ」か「サ」で始まり、「ユキ」を含む | `^[サナ].*?ユキ.*?` |
| **5.** | 空白以外の同じ文字の繰り返しを含む | `(\S)\1` |

---

## III. 課題2

課題の要求（行全体のマッチング）と実用的な利用（文中の抽出）の両方に対応した、よりロバストな回答を提出します。

### 1. 偶数にマッチする正規表現 (RegEx for Even Numbers)
| 用途 (Usage) | 提出正規表現 (Submitted RegEx) |
| :--- | :--- |
| **厳密な検証** (Strict Validation) | `^[0-9]*[02468]$` |
| **文中の抽出** (Contextual Extraction) | `\b[0-9]*[02468]\b` |

### 2. 郵便番号にマッチする正規表現 (RegEx for Postal Codes)
| 用途 (Usage) | 提出正規表現 (Submitted RegEx) |
| :--- | :--- |
| **厳密な検証** (Strict Validation) | `^[0-9]{3}-?[0-9]{4}$` |
| **文中の抽出** (Contextual Extraction) | `\b[0-9]{3}-?[0-9]{4}\b` |

### Word Boundary ( `\b` ) の導入
当初、偶数マッチの検証に `^[0-9]*[02468]$` を使用した際、「`the number 6` のような文字列からは `6` を抽出できない」という問題に気づきました。これは、`^` と `\$` が文字列の境界（Start/End of String）しか見ていないためです。

この問題を解決するため、ネットで調べた上でWord Boundary ( `\b` ) を使用するようになりました。`\b` は、単語文字と非単語文字（スペース、句読点、行の開始/終了）の間にマッチするアンカーであり、これにより、パターンが文中の独立した単語（数字）として正しく認識と抽出されるようになりました。この違いは、厳密な入力フォームの検証（`^...$`）と、テキストからのデータ抽出（`\b...\b`）という実用的な側面を理解する上で重要だと思います。

---

## IV. 課題3　　

**条件:** 「st」で始まり、「語中に2つ以上連続する同じ文字かつ末尾が`'l'`」または「`'ll'`で終わる」単語。

| 条件 (Requirement) | 提出正規表現 (Submitted RegEx) |
| :--- | :--- |
| **基本回答** (Repetition and ends in 'l') | `^st.*?(\S)\1.*?l$` |
| **追加点** (Repetition and ends in 'l' OR No repetition and ends in 'll') | `^st.*?((\S)\2.*?\|l)l$` |

### バックリファレンス (`\2`) の修正と成功

当初、追加点用の複雑な正規表現を試した際、論理的な構造は正しいにも関わらず、期待した結果が得られませんでした。

**失敗の試行:**
初期のパターンでは、ネストされたキャプチャグループ内のバックリファレンスを誤って指定していました。この複雑な構造では、`(\S)` で文字をキャプチャするグループを **Group 2** として正確に参照する必要がありました。

**成功の要因:**
最終的に、パターンを `^st.*?((\S)\2.*?|l)l$` の形に修正し、バックリファレンスを **`\2`** に設定することで成功しました。これにより、エンジンは「Group 2でキャプチャした文字と同一の文字」を正しく参照できるようになり、以下の複雑な論理が機能するようになりました。

* `(\S)`: 文字をキャプチャする **Group 2**。
* `\2`: **Group 2** の内容を参照し、繰り返しを強制する。

この修正により、パターンはネストされたキャプチャグループを使用しながら、基本的なRegEx機能の範囲内で、複雑な条件分岐と繰り返しパターンを正確に処理することができました。

---

## V. 感想と質問 (Comments and Questions)

### 質問 (Question)
HTTPヘッダインジェクション攻撃 (HTTP Header Injection Attack) を防ぐために、サーバー側でどのような対策を講じるべきでしょうか。また、それらの対策はユーザー体験 (UX) を損なうことなく実現可能でしょうか。

### 感想 (Comment)
今度の授業もよく理解できました。
